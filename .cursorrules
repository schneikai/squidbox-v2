Squidbox v2 — Project structure (concise)

Monorepo

- pnpm workspaces + Turbo. Node 20.17.0 (use `nvm use`).
- Root scripts: `pnpm dev` (parallel), `pnpm build`.

apps/mobile (Expo React Native app)

- Routing in `apps/mobile/app/*` via expo-router.
- UI in `components/*`; state/logic in `contexts/*`, `hooks/*`.
- Talks to API via `services/backend.ts`.

apps/api (Express API + Prisma)

- Dev entry: `apps/api/src/index.ts`. Launchers: `src/api-main.ts`, `src/worker-main.ts`.
- Routes in `src/routes/*` (auth, users, health). Auth in `src/auth.ts`.
- Prisma schema `prisma/schema.prisma`; migrations in `prisma/migrations/*`.
- Queues in `src/queue.ts`; env in `src/env.ts` (`env.example`).
- Tests in `tests/*`; deployment via `fly.*.toml`; Docker for db/redis.

packages/contracts (shared types/schemas)

- Source `packages/contracts/src/index.ts`; built by tsup to `dist/*`.
- Imported as `@squidbox/contracts` by API and Mobile.

Conventions

- Put shared Zod schemas/types in `packages/contracts` (avoid duplication).
- When contracts change: update contracts → API routes → Mobile `services/backend.ts`.

Useful commands

- All: `pnpm dev`. API only: `pnpm -C apps/api dev`. Mobile: `pnpm -C apps/mobile dev`.
- API env: copy `apps/api/env.example` to `.env`; use Docker Compose for db/redis when needed.
